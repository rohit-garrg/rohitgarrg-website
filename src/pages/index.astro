---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import ArticleCard from '../components/ArticleCard.astro';

// Get articles from content collection, sorted by date (newest first), limit to 3
const allArticles = await getCollection('writing');

const latestArticles = allArticles
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3)
  .map(article => {
    const slug = article.id.replace(/\.md$/, '');
    return {
      title: article.data.title,
      description: article.data.description,
      category: article.data.category,
      date: article.data.date,
      slug,
      leadImage: article.data.leadImage
    };
  });

// Placeholder projects
const placeholderProjects = [
  {
    title: "Project Coming Soon",
    description: "Hobby builds and experiments will appear here."
  }
];

// WebSite schema for homepage
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Rohit Garg",
  "description": "Head of Product & Design at Times of India. Writing about product management, leadership, and AI tools.",
  "url": "https://rohitgarrg.com",
  "author": {
    "@type": "Person",
    "name": "Rohit Garg",
    "jobTitle": "Head of Product & Design",
    "worksFor": {
      "@type": "Organization",
      "name": "Times of India"
    }
  }
};
---

<BaseLayout>
  <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
  <div class="container">
    <!-- Hero Section -->
    <section class="hero">
      <h1>Rohit Garg</h1>
      <p class="tagline">Product at scale. Built with AI.</p>
      <p class="subtitle">Head of Product & Design at Times of India</p>
      <div class="social-links">
        <a href="https://www.linkedin.com/in/rohitgarrg/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
        <a href="mailto:rohitgarrg@gmail.com">Email</a>
      </div>
    </section>

    <!-- Latest Writing Section -->
    <section class="section">
      <div class="section-header">
        <h2>Latest Writing</h2>
        <a href="/writing" class="view-all">View all â†’</a>
      </div>
      <div class="articles-grid">
        {latestArticles.length > 0 ? (
          latestArticles.map((article) => (
            <ArticleCard
              title={article.title}
              description={article.description}
              category={article.category}
              date={article.date}
              slug={article.slug}
              leadImage={article.leadImage}
            />
          ))
        ) : (
          <p class="empty-state">Articles coming soon.</p>
        )}
      </div>
    </section>

    <!-- Projects Section -->
    <section class="section section-projects">
      <div class="section-header">
        <h2>Projects</h2>
      </div>
      <div class="projects-placeholder">
        <div class="project-card placeholder">
          <div class="placeholder-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2L2 7l10 5 10-5-10-5z"/>
              <path d="M2 17l10 5 10-5"/>
              <path d="M2 12l10 5 10-5"/>
            </svg>
          </div>
          <h3>Side Projects & Experiments</h3>
          <p>Currently building things in the open. Check back soon for AI-powered tools, product experiments, and hobby builds.</p>
        </div>
      </div>
    </section>
  </div>
</BaseLayout>

<style>
  .hero {
    min-height: 50vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    padding: var(--space-xl) 0;
  }

  h1 {
    font-size: 3.5rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    margin-bottom: var(--space-sm);
  }

  .tagline {
    font-size: 1.5rem;
    font-weight: 500;
    background: linear-gradient(135deg, var(--color-accent) 0%, #7c3aed 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: var(--space-xs);
  }

  .subtitle {
    font-size: 1.125rem;
    color: var(--color-text-light);
    margin-bottom: var(--space-md);
  }

  .social-links {
    display: flex;
    gap: var(--space-md);
  }

  .social-links a {
    font-size: 0.9375rem;
    font-weight: 500;
  }

  .section {
    padding: var(--space-xl) 0;
    border-top: 1px solid var(--color-border);
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-lg);
    gap: var(--space-md);
  }

  .section-header h2 {
    margin-bottom: 0;
  }

  .view-all {
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
    padding: var(--space-xs) var(--space-sm);
    border-radius: 6px;
    transition: background-color 0.2s ease;
  }

  .view-all:hover {
    background-color: rgba(37, 99, 235, 0.08);
  }

  .articles-grid {
    display: grid;
    gap: var(--space-md);
  }

  .projects-placeholder {
    display: grid;
    gap: var(--space-md);
  }

  .section-projects {
    padding-bottom: var(--space-lg);
  }

  .project-card {
    padding: var(--space-lg);
    border: 1px solid var(--color-border);
    border-radius: 8px;
  }

  .project-card.placeholder {
    text-align: center;
    color: var(--color-text-light);
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    padding: var(--space-xl) var(--space-lg);
  }

  .placeholder-icon {
    color: var(--color-accent);
    opacity: 0.6;
    margin-bottom: var(--space-md);
  }

  .project-card h3 {
    margin-bottom: var(--space-sm);
    color: var(--color-text);
    font-size: 1.125rem;
  }

  .project-card p {
    margin-bottom: 0;
    font-size: 0.9375rem;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
  }

  @media (max-width: 768px) {
    .hero {
      min-height: 40vh;
      padding: var(--space-lg) 0;
    }

    h1 {
      font-size: 2.5rem;
      letter-spacing: -0.01em;
    }

    .tagline {
      font-size: 1.25rem;
    }

    .subtitle {
      font-size: 1rem;
    }

    .section-header {
      flex-direction: column;
      gap: var(--space-xs);
    }
  }
</style>
